<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Publikationsorte Karte</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
  <style>
    body { margin: 0; font-family: sans-serif; }
    #map { height: 100vh; width: 100vw; }
  </style>
</head>
<body>
  <div id="map"></div>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    // Erstelle die Karte und setze den Startpunkt
    const map = L.map('map').setView([60, 10], 4); // Zentrale Position in Nordeuropa
    // OpenStreetMap als Grundkarte
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
      maxZoom: 18
    }).addTo(map);
    // Daten aus der Tabelle (Liste_Kartensammlung.csv)
    const locations = [
      { name: "[Kart over Nord-Europa]", publisher: "Camocio, Giovanni Francesco", year: 1562, place: "Venice", link: "https://hdl.handle.net/10037.2/747" },
      { name: "Septentrionalium regionum descrip.", publisher: "Ortelius, Abraham", year: 1592, place: "Antwerp", link: "https://hdl.handle.net/10037.2/748" },
      { name: "Septentrionalium regionum descrip.", publisher: "Ortelius, Abraham", year: 1595, place: "Antwerp", link: "https://hdl.handle.net/10037.2/749" },
      { name: "Suecia et Noruegia cum confinys Per Gerardum Mercatorem", publisher: "Mercator, Gerard", year: 1613, place: "Duisburg", link: "https://hdl.handle.net/10037.2/753" },
      { name: "Suecia et Noruegia cum confinys Per Gerardum Mercatorem", publisher: "Mercator, Gerard", year: 1619, place: "Amsterdam", link: "https://hdl.handle.net/10037.2/758" },
      { name: "Polus Arcticus, siue Tract[us] Septentrionalis", publisher: "Quad, Matthias", year: 1600, place: "Cologne", link: "https://hdl.handle.net/10037.2/742" },
      { name: "Nortcaep", publisher: "Becker, Matthäus", year: 1612, place: "Amsterdam", link: "https://hdl.handle.net/10037.2/740" },
      { name: "Septentrionalum regionu[m] descrip. Petrus Kaerius fecit et caelavit", publisher: "Keere, Pieter van den", year: 1606, place: "Amsterdam", link: "https://hdl.handle.net/10037.2/739" },
      { name: "Scandia siue regiones septentrionales", publisher: "Magini, Giovanni Antonio", year: 1597, place: "Cologne", link: "https://hdl.handle.net/10037.2/735" },
      { name: "Tab. Noua Nor. & Goti.", publisher: "Fries, Lorenz", year: 1522, place: "Strasbourg", link: "https://hdl.handle.net/10037.2/574" },
      { name: "Tabula moderna Norbegie et Gottie", publisher: "Waldseemüller, Martin", year: 1513, place: "Strasbourg", link: "https://hdl.handle.net/10037.2/571" }
    ];
    // Funktion zur Geokodierung (Umwandlung von Ortsnamen in Koordinaten)
    async function geocodeLocation(location) {
      const response = await fetch(`https://nominatim.openstreetmap.org/search?city=${location}&format=json`);
      const data = await response.json();
      if (data.length > 0) {
        return [parseFloat(data[0].lat), parseFloat(data[0].lon)];
      } else {
        console.error(`Ort nicht gefunden: ${location}`);
        return null; // Ort nicht gefunden
      }
    }
    // Marker für jeden Publikationsort hinzufügen
    async function addMarkers() {
      for (const loc of locations) {
        const coords = await geocodeLocation(loc.place);
        if (coords) {
          // Füge einen Marker hinzu, wenn Koordinaten gefunden wurden
          const marker = L.marker(coords).addTo(map);
          marker.bindPopup(`
            <strong>${loc.name}</strong><br>
            <em>Publisher:</em> ${loc.publisher}<br>
            <em>Year:</em> ${loc.year}<br>
            <em>Place:</em> ${loc.place}<br>
            <a href="${loc.link}" target="_blank">Permalink</a>
          `);
        } else {
          // Füge einen Standard-Marker für unbekannte Orte hinzu
          const marker = L.marker([0, 0]).addTo(map); // Standardkoordinaten (Äquator)
          marker.bindPopup(`
            <strong>${loc.name}</strong><br>
            <em>Publisher:</em> ${loc.publisher}<br>
            <em>Year:</em> ${loc.year}<br>
            <em>Place:</em> <em>Unbekannt</em><br>
            <a href="${loc.link}" target="_blank">Permalink</a>
          `);
        }
      }
    }
    // Marker hinzufügen
    addMarkers();
  </script>
</body>
</html>
